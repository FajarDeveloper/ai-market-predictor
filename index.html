<!DOCTYPE html>
<html lang="id" data-theme="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MGLYZER 2.2 - AI Market Analysis</title>
    
    <meta name="monetag" content="28cd66a48a557b8bfa51174459c7f7bc">

    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    
    <style>
      /* ===== MODERN FUTURISTIC THEME ===== */
      
      /* 1. Reset & Root Variables */
      *, *::before, *::after {
        box-sizing: border-box;
        margin: 0;
        padding: 0;
      }

      :root {
        --radius-sm: 8px;
        --radius-md: 14px;
        --radius-lg: 20px;
        --transition-speed: 0.3s;
      }

      /* 2. Light & Dark Theme Color Palette */
      html[data-theme="light"] {
        --color-primary: #2563eb;
        --color-primary-dark: #1e40af;
        --color-primary-glow: rgba(37, 99, 235, 0.4);
        --color-text: #0f172a;
        --color-text-muted: #475569;
        --color-bg: #f0f4f9;
        --color-bg-gradient: linear-gradient(135deg, #e0e8f6 0%, #f0f4f9 100%);
        --color-card-bg: rgba(255, 255, 255, 0.7);
        --color-border: rgba(0, 0, 0, 0.1);
        --color-shadow: rgba(15, 23, 42, 0.1);
        --color-success: #16a34a;
        --color-error: #ef4444;
        --color-input-bg: rgba(255, 255, 255, 0.8);
      }

      html[data-theme="dark"] {
        --color-primary: #38bdf8; /* Light Blue */
        --color-primary-dark: #1e40af;
        --color-primary-glow: rgba(56, 189, 248, 0.3);
        --color-text: #e2e8f0; /* Light Gray */
        --color-text-muted: #94a3b8; /* Slate 400 */
        --color-bg: #0b1120;
        --color-bg-gradient: linear-gradient(135deg, #0f172a 0%, #0b1120 100%);
        --color-card-bg: rgba(15, 23, 42, 0.5); /* Semi-transparent dark blue */
        --color-border: rgba(255, 255, 255, 0.1);
        --color-shadow: rgba(0, 0, 0, 0.2);
        --color-success: #22c55e;
        --color-error: #f43f5e;
        --color-input-bg: rgba(15, 23, 42, 0.7);
      }

      /* 3. Base & Body Styles */
      html, body {
        height: 100%;
        scroll-behavior: smooth;
      }

      body {
        font-family: 'Poppins', system-ui, -apple-system, sans-serif;
        background-color: var(--color-bg);
        background-image: var(--color-bg-gradient);
        color: var(--color-text);
        margin: 0;
        /* PADDING DIHAPUS DARI SINI */
        line-height: 1.7;
        transition: background-color var(--transition-speed) ease, color var(--transition-speed) ease;
      }
      
      /* GAMBAR DIBUAT RESPONSIVE SECARA GLOBAL (DITAMBAHKAN) */
      img {
        max-width: 100%;
        height: auto;
        display: block; /* Menghilangkan spasi ekstra di bawah gambar */
      }
      
      /* ... CSS sebelumnya tidak berubah ... */
      
      /* 4. Layout Container (PERBAIKAN UTAMA) */
      .container {
        /* width: 100%; (DIHAPUS) - Ini adalah penyebab utama masalah overflow */
        max-width: 1200px;
        margin: 0 auto;
        display: flex;
        flex-direction: column;
        gap: 32px;
        padding: 32px 24px;
      }

      /* 5. Header (PERBAIKAN TAMBAHAN) */
      header {
  text-align: center;
  position: relative; 
  padding-top: 30px; /* Memberi ruang di atas untuk toolbar */
  padding-bottom: 30px;
}
      
      header .controls {
  position: absolute;
  top: 10px; /* Jarak dari atas halaman */
  left: 50%; /* Posisikan ke tengah secara horizontal */
  transform: translateX(-50%); /* Sempurnakan posisi agar benar-benar di tengah */
        display: flex;
        gap: 12px;
        background: var(--color-card-bg);
        border: 1px solid var(--color-border);
        padding: 8px;
        border-radius: var(--radius-lg);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
      }
      
      .control-btn {
        appearance: none;
        border: none;
        background: transparent;
        color: var(--color-text-muted);
        padding: 6px 10px;
        border-radius: var(--radius-sm);
        cursor: pointer;
        font-size: 1rem;
        font-weight: 600;
        transition: all
        var(--transition-speed) ease;
      }
      .control-btn:hover {
        color: var(--color-primary);
        background: rgba(255,255,255,0.1);
      }
      .control-btn.active {
        background: var(--color-primary);
        color: var(--color-bg);
      }
      #theme-toggle { font-size: 1.2rem; padding: 4px 8px; }

      header h1 {
  font-size: clamp(2.2rem, 5vw, 3.5rem);
  font-weight: 800;
  color: var(--color-primary);
  text-shadow: 0 0 20px var(--color-primary-glow);
  margin-top: 50; /* Margin atas dihapus karena sudah diatasi oleh padding header */
  margin-bottom: 0px;
}
      .subtitle {
  color: var(--color-text-muted);
  font-size: clamp(1rem, 2vw, 1.15rem);
  max-width: 700px;
  margin: 0 auto 0px auto; /* Nilai ketiga (margin-bottom) diubah dari 24px menjadi 16px */
}
      
      /* ... Sisa kode CSS tidak perlu diubah karena sudah mengikuti struktur yang benar ... */
      
      /* 6. Main Content Grid */
      main {
        display: grid;
        grid-template-columns: 1fr;
        gap: 32px;
      }
      @media (min-width: 992px) {
        main { grid-template-columns: 1fr 1fr; }
      }

      /* 7. Card Styling (Glassmorphism) */
      .card {
        background: var(--color-card-bg);
        border: 1px solid var(--color-border);
        padding: clamp(20px, 3vw, 32px);
        border-radius: var(--radius-lg);
        box-shadow: 0 8px 32px 0 var(--color-shadow);
        backdrop-filter: blur(12px);
        -webkit-backdrop-filter: blur(12px);
        transition: transform var(--transition-speed) ease, box-shadow var(--transition-speed) ease;
      }
      .card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px 0 var(--color-shadow);
      }
      .card h2 {
        font-size: clamp(1.2rem, 3vw, 1.5rem);
        font-weight: 700;
        color: var(--color-text);
        margin: 0 0 24px;
        padding-bottom: 12px;
        border-bottom: 2px solid var(--color-primary);
        display: flex;
        align-items: center;
        gap: 12px;
      }
      /* 8. Form Elements */
      .form-group { margin-bottom: 20px; }
      label {
        display: block;
        margin-bottom: 8px;
        font-weight: 600;
        color: var(--color-text-muted);
        font-size: 0.95rem;
      }
      input[type="text"], select, textarea {
        width: 100%;
        padding: 14px;
        border: 1px solid var(--color-border);
        border-radius: var(--radius-sm);
        font-size: 1rem;
        font-family: 'Poppins', sans-serif;
        background: var(--color-input-bg);
        color: var(--color-text);
        transition: all var(--transition-speed) ease;
      }
      input[type="text"]:focus, select:focus, textarea:focus {
        outline: none;
        border-color:
        var(--color-primary);
        box-shadow: 0 0 0 4px var(--color-primary-glow);
        background: var(--color-card-bg);
      }
      textarea { resize: vertical; min-height: 100px; }

      /* 9. Upload Area */
      .upload-area {
        border: 2px dashed var(--color-border);
        border-radius: var(--radius-md);
        padding: 32px;
        text-align: center;
        cursor: pointer;
        transition: all var(--transition-speed) ease;
      }
      .upload-area:hover, .upload-area.drag-over {
        border-color: var(--color-primary);
        background: var(--color-primary-glow);
        transform: scale(1.02);
      }
      .upload-area i {
        font-size: 2.5rem;
        color: var(--color-primary);
        margin-bottom: 12px;
      }
      .upload-area p { color: var(--color-text-muted); }
      .upload-area img.preview {
        max-width: 100%;
        max-height: 200px;
        margin-top: 16px;
        border-radius: var(--radius-sm);
      }
      .upload-area .file-name {
        margin-top: 10px;
        font-weight: 500;
      }
      #chartImageInput { display: none; }
      
      /* 10. Buttons */
      .btn {
        padding: 14px 24px;
        border: none;
        border-radius: var(--radius-md);
        cursor: pointer;
        font-size: 1.05rem;
        font-weight: 700;
        font-family: 'Poppins', sans-serif;
        display: inline-flex;
        align-items: center;
        justify-content: center;
        gap: 10px;
        transition: all var(--transition-speed) ease;
        text-decoration: none;
      }
      .primary-btn {
        width: 100%;
        margin-top: 12px;
        color: #fff;
        background: linear-gradient(45deg, var(--color-primary), var(--color-primary-dark));
        box-shadow: 0 10px 20px -5px var(--color-primary-glow);
      }
      .primary-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 14px 25px -5px var(--color-primary-glow);
      }
      .primary-btn:active { transform: translateY(0); }
      .primary-btn:disabled {
        background: var(--color-text-muted);
        cursor: not-allowed;
        box-shadow: none;
        opacity: 0.7;
      }
      .loading-spinner {
        border: 3px solid rgba(255,255,255,.3);
        border-top: 3px solid #fff;
        width: 20px; height: 20px;
        border-radius: 50%;
        animation: spin 1s linear infinite;
      }
      @keyframes spin { to { transform: rotate(360deg); } }

      /* 11. Output Section */
      .analysis-result {
        background: var(--color-input-bg);
        padding: 20px;
        border-radius: var(--radius-md);
        min-height: 250px;
        color: var(--color-text);
        white-space: pre-wrap;
        word-break: break-word;
        font-size: 0.95rem;
      }
      .analysis-result .placeholder-text { color: var(--color-text-muted); }
      .result-item {
        margin-bottom: 16px; padding-bottom: 16px;
        border-bottom: 1px dashed var(--color-border);
        }
      .result-item:last-child { border: none; margin: 0; padding: 0; }
      .result-item h3 {
        margin: 0 0 8px; font-size: 1.1rem; color: var(--color-primary); font-weight: 600;
      }

      /* 12. Message Boxes */
      .message-box {
        margin-top: 16px; padding: 14px; border-radius: var(--radius-sm);
        text-align: center; font-weight: 600; border: 1px solid transparent;
      }
      .success-message { background: rgba(34,197,94,.15); color: var(--color-success); border-color: var(--color-success); }
      .error-message { background: rgba(244,63,94,.15); color: var(--color-error); border-color: var(--color-error); }

      /* GANTI SELURUH BLOK INI DI CSS ANDA */

/* 13. Broker Info Box */
.info-box {
    background: linear-gradient(135deg, var(--color-primary), var(--color-primary-dark));
    color: white;
    padding: 32px;
    border-radius: var(--radius-lg);
    grid-column: 1 / -1;
    
    /* PROPERTI BARU UNTUK MEMPERBAIKI TATA LETAK */
    display: flex;
    flex-direction: column;
    align-items: center;
}

.info-box h3 { 
    font-size: 1.8rem; 
    margin-bottom: 8px; 
    text-align: center; /* Memastikan teks tetap di tengah */
}

.info-box p {
    margin-bottom: 24px;
    text-align: center; /* Memastikan teks tetap di tengah */
}

.info-box .btn { 
    background: #fff; 
    color: var(--color-primary-dark); 
    margin-top: 16px;
}

.info-box .btn:hover { 
    background: #eef; 
}

/* (MODIFIKASI UTAMA) Grid untuk daftar fitur */
.highlights-grid {
    display: grid;
    grid-template-columns: 1fr 1fr; /* Membuat 2 kolom */
    gap: 16px; /* Jarak antar item */
    text-align: left;
    max-width: 500px;
    margin: 24px auto;
}

/* (CLASS BARU) Styling untuk setiap item fitur */
.highlight-item {
    display: flex;
    align-items: center;
    gap: 10px; /* Jarak antara ikon dan teks */
    font-size: 0.95rem;
}

/* (CLASS BARU) Menambahkan ikon centang menggunakan Font Awesome */
.highlight-item::before {
    font-family: "Font Awesome 6 Free";
    content: "\f00c"; /* Kode unicode untuk ikon centang */
    font-weight: 900;
    color: var(--color-success);
    font-size: 1.1rem;
}

      /* 14. Reviews Section */
      .reviews-section { grid-column: 1 / -1; }
      .reviews-container {
    display: grid; 
/* Mengubah dari flex menjadi grid */
    /* Membuat kolom yang otomatis mengisi ruang dan memiliki lebar minimum 300px */
    grid-auto-flow: column;
    grid-auto-columns: minmax(300px, 1fr); 
    overflow-x: auto;
    gap: 20px;
    padding: 10px;
    scrollbar-width: thin;
    scrollbar-color: var(--color-primary) transparent;
}
      .reviews-container::-webkit-scrollbar { height: 8px; }
      .reviews-container::-webkit-scrollbar-thumb { background: var(--color-primary); border-radius: 10px; }
      .review {
        min-width: 300px;
        flex-shrink: 0;
        background: var(--color-card-bg);
        border: 1px solid var(--color-border);
        padding: 20px;
        border-radius: var(--radius-md);
      }
      .review .stars { color: #f39c12; font-size: 1.2rem; margin: 8px 0; }
      .review .username { font-weight: 600; color: var(--color-text); }
      .review .comment { font-size: 0.9rem; color: var(--color-text-muted); }
      .review .date { font-size: 0.8rem; color: var(--color-text-muted); margin-top: 12px; }
      
      /* 15. Footer & Social Icons */
      footer {
        text-align: center;
        margin-top: 20px;
        color: var(--color-text-muted);
        font-size: 0.9rem;
      }
      .social-media-icons { display: flex; justify-content: center; gap: 24px; margin-bottom: 16px; }
      .social-icon { font-size: 1.8rem; color: var(--color-text-muted); text-decoration: none; transition: all var(--transition-speed) ease; }
      .social-icon:hover { color: var(--color-primary); transform: translateY(-3px); }

      /* Floating Nav Bar */
      #floatingNavBar {
        position: fixed;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        background: var(--color-card-bg);
        backdrop-filter: blur(10px);
        -webkit-backdrop-filter: blur(10px);
        padding: 12px 20px;
        border-radius: 50px;
        border: 1px solid var(--color-border);
        box-shadow: 0 4px 12px var(--color-shadow);
        z-index: 1000;
        display: flex; gap: 25px;
        transition: all var(--transition-speed) ease;
      }
      #floatingNavBar:hover { transform: translateX(-50%) translateY(-3px); }
      .navigation-icon {
        font-size: 1.5rem;
        color: var(--color-text-muted);
        transition: color var(--transition-speed) ease;
      }
      .navigation-icon:hover { color: var(--color-primary); }
 
/* ============================================ */
/* PERBAIKAN OVERFLOW FINAL (TAMBAHKAN DI AKHIR) */
/* ============================================ */
main, main * {
  min-width: 0;
}
/* ============================================== */
/* PERBAIKAN FINAL UNTUK INFO-BOX (TAMBAHKAN INI) */
/* ============================================== */

/* Memaksa setiap anak langsung dari .info-box untuk menjadi blok penuh */
.info-box > * {
    width: 100% !important;
    max-width: 100% !important;
}

/* Mengatur ulang grid fitur agar tetap di tengah dalam wadah barunya */
.highlights-grid {
    margin: 24px auto !important;
    max-width: 500px !important; /* Pastikan grid tidak terlalu lebar di desktop */
}
   </style>
</head>
<body>
    <div class="container">
        <header>
            <div class="controls">
                <button id="langEnBtn" class="control-btn" data-lang="en">EN</button>
                <button id="langIdBtn" class="control-btn" data-lang="id">ID</button>
                <button id="theme-toggle" class="control-btn" aria-label="Toggle dark mode">
                    <i class="fas fa-moon"></i>
                </button>
            </div>
             <a href="https://lynk.id/mgtrade/">
              <img src="https://imgpx.com/Dd4UjbwERpzv.png" width="100%" height="auto" style="max-width: 100%; margin: 0 auto;"/>
            </a>
            
            <h1 id="headerTitle">MGLYZER</h1>
            <p id="headerSubtitle" class="subtitle">Upload your latest chart screenshot and let AI analyze market direction for Crypto, Forex, and Commodities.</p>
        </header>

        <main>
            <section class="input-section card">
                <h2 id="inputSectionTitle"><i class="fas fa-upload"></i> Upload Chart & Details</h2>
                <form id="chartAnalysisForm">
    <div class="form-group">
        <label id="labelAssetType" for="assetType">Asset Type:</label>
        <select id="assetType" required></select>
    </div>

    <div class="form-group">
        <label id="labelAdditionalNotes" for="additionalNotes">Additional Context/Notes (Optional):</label>
        <textarea id="additionalNotes" rows="3" placeholder="e.g., 'Looking for resistance levels', 'Is this a bullish setup?'"></textarea>
    </div>

    <div class="form-group">
        <label id="labelUploadChart">Upload Chart Screenshot:</label>
        <div id="uploadArea" class="upload-area">
            <input type="file" id="chartImageInput" accept="image/*" required>
            <i class="fas fa-file-image"></i>
            <p id="uploadAreaText">Drag & drop your image here, or click to browse</p>
            <img id="imagePreview" class="preview" style="display: none;">
            <div id="fileNameDisplay" class="file-name" style="display: none;"></div>
        </div>
    </div>

    <button type="submit" id="analyzeBtn" class="btn primary-btn">
        <span id="buttonText">Analyze Chart</span>
        <span id="loadingSpinner" class="loading-spinner" style="display: none;"></span>
    </button>
</form>
            </section>
            
            <section class="output-section card">
                <h2 id="outputSectionTitle"><i class="fas fa-chart-line"></i> Analysis Results</h2>
                <div id="analysisResult" class="analysis-result">
                    <p id="placeholderAnalysis" class="placeholder-text">Upload a chart and click 'Analyze Chart' to see the AI's prediction here.</p>
                </div>
                <div id="message" class="message-box" style="display: none;"></div>
            </section>
            
            <section class="info-box">
    <h3>Broker dengan Spread 0.0 Pip!</h3>
    <p>Deposit cukup mulai dari Rp20.000 saja.</p>
    <img src="https://imgpx.com/RfVLW1IaqwTY.png" alt="Broker Promotion" style="max-width: 400px; border-radius: var(--radius-md); margin: 20px auto;"/>
    
    <div class="highlights-grid">
        <div class="highlight-item">Berlisensi FSCA</div>
        <div class="highlight-item">Eksekusi Instan</div>
        <div class="highlight-item">Akun Standar, Cent & Pro</div>
        <div class="highlight-item">Tanpa Komisi WD/Deposit</div>
        <div class="highlight-item">Leverage 1:Unlimited</div>
        <div class="highlight-item">CopyTrading Tersedia</div>
        <div class="highlight-item">Bonus Deposit</div>
        <div class="highlight-item">Edukasi Gratis</div>
    </div>
    
    <button id="registerButton" class="btn" onclick="openLink()">Daftar Sekarang <i class="fas fa-arrow-right"></i></button>
</section>

            <section class="reviews-section card">
                <h2><i class="fas fa-star"></i> Ulasan Teratas</h2>
                <div class="reviews-container">
                    <div class="review">
                        <div class="username">Satria Wira Yudha</div>
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <div class="comment">Terima kasih MGLYZER karena sudah menghadirkan AI yang sangat bermanfaat bagi trading saya🥰</div>
                        <div class="date">Dikirim pada: 10 September 2025</div>
                         </div>
                    <div class="review">
                        <div class="username">Bagus Adi Nugraha</div>
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <div class="comment">Sangat akurat, semoga layanan ini terus bertahan untuk membantu banyak orang.</div>
                        <div class="date">Dikirim pada: 10 September 2025</div>
                    </div>
                    <div class="review">
                        <div class="username">Alifa Zea Amanda</div>
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <div class="comment">Sehat terus buat developernya karena sudah membuat alat bantu trading sehebat ini bahkan gratissss🫵😭😭</div>
                        <div class="date">Dikirim pada: 10 September 2025</div>
                         </div>
                    <div class="review">
                        <div class="username">Syalwa Anantasya</div>
                        <div class="stars">⭐⭐⭐⭐</div>
                        <div class="comment">AI nya bagus banget kakk, semoga versi aslinya segera rilis karena sangat membantu pemula seperti saya😭🙏</div>
                        <div class="date">Dikirim pada: 9 September 2025</div>
                    </div>
                    <div class="review">
                        <div class="username">Fharel Putra Pramadiyono</div>
                        <div class="stars">⭐⭐⭐⭐⭐</div>
                        <div class="comment">Setelah ada AI ini saya jadi semakin pede untuk membuka posisi🔥</div>
                        <div class="date">Dikirim pada: 9 September 2025</div>
                         </div>
                </div>
            </section>
        </main>

        <footer>
            <div class="social-media-icons">
                <a href="https://www.instagram.com/dfajar22_" target="_blank" class="social-icon"><i class="fab fa-instagram"></i></a>
                <a href="https://www.tiktok.com/@masterofgold_id" target="_blank" class="social-icon"><i class="fab fa-tiktok"></i></a>
                <a href="https://chat.whatsapp.com/IACHnHTIwpr4SIgB1AbChE?mode=ems_copy_c" target="_blank" class="social-icon"><i class="fab fa-whatsapp"></i></a>
                <a href="https://t.me/penjarahemass" target="_blank" class="social-icon"><i class="fab fa-telegram"></i></a>
            </div>
            <p id="footerText">&copy; 2025 MGLYZER 2.2 by MG Trade. All rights reserved.</p>
        </footer>
    </div>
    
    <div id="floatingNavBar">
        <a href="https://mglyzer.biz.id/comment.html" target="_blank" class="navigation-icon"><i class="fa fa-star"></i></a>
        <a href="https://mglyzer.biz.id/info.html" target="_blank" class="navigation-icon"><i class="fa fa-info-circle"></i></a>
        <a href="https://mglyzer.biz.id/crown.html" target="_blank" class="navigation-icon"><i class="fa fa-crown"></i></a>
        <a href="https://mglyzer.biz.id/install.html" target="_blank" class="navigation-icon"><i class="fa fa-download"></i></a>
    </div>

    <script>
    document.addEventListener('DOMContentLoaded', () => {
        const langEnBtn = document.getElementById('langEnBtn');
        const langIdBtn = document.getElementById('langIdBtn');

        const headerTitle = document.getElementById('headerTitle');
        const headerSubtitle = document.getElementById('headerSubtitle');
        const inputSectionTitle = document.getElementById('inputSectionTitle');
        // NAMA VARIABEL TETAP SAMA
        const labelAssetType = document.getElementById('labelAssetType');
        const labelAdditionalNotes = document.getElementById('labelAdditionalNotes');
        const additionalNotesTextarea = document.getElementById('additionalNotes');
        const labelUploadChart = document.getElementById('labelUploadChart');
        const uploadAreaText = document.getElementById('uploadAreaText');
        const analyzeBtn = document.getElementById('analyzeBtn');
        const buttonText = document.getElementById('buttonText');
        const outputSectionTitle = document.getElementById('outputSectionTitle');
        const placeholderAnalysis = document.getElementById('placeholderAnalysis');
        const footerText = document.getElementById('footerText');
        const messageBox = document.getElementById('message');
        
        // NAMA VARIABEL TETAP SAMA
        const assetTypeSelect = document.getElementById('assetType');

        const chartAnalysisForm = document.getElementById('chartAnalysisForm');
        const chartImageInput = document.getElementById('chartImageInput');
        const uploadArea = document.getElementById('uploadArea');
        const imagePreview = document.getElementById('imagePreview');
        const fileNameDisplay = document.getElementById('fileNameDisplay');
        const loadingSpinner = document.getElementById('loadingSpinner');
        const analysisResultDiv = document.getElementById('analysisResult');

        let uploadedFile = null;
        let currentLang = localStorage.getItem('appLang') || 'en';

        // DIUBAH: Teks terjemahan diubah menjadi "Currency", namun KEY tetap "labelAssetType"
        const translations = {
            en: {
                headerTitle: "MGLYZER 2.2",
                headerSubtitle: "Upload your latest chart screenshot and let AI analyze market direction for Crypto, Forex, and Commodities.",
                inputSectionTitle: "Upload Chart & Details",
                labelAssetType: "Currency:", // Teks diubah, key tetap
                labelAdditionalNotes: "Additional Context/Notes (Optional):",
                placeholderNotes: "e.g., 'Looking for resistance levels', 'Is this a bullish setup?'",
                labelUploadChart: "Upload Chart Screenshot:",
                uploadAreaText: "Drag & drop your image here, or click to browse",
                analyzeButton: "Analyze Chart",
                analyzingButton: "Analyzing...",
                outputSectionTitle: "Analysis Results",
                placeholderAnalysis: "Upload a chart and click 'Analyze Chart' to see the AI's prediction here.",
                footerText: "&copy; 2025 MGLYZER 2.2 by MG Trade. All rights reserved.",
                msgUploadImage: "Please upload an image file (e.g., JPG, PNG).",
                msgFileSize: "Image file size exceeds 5MB. Please upload a smaller image.",
                msgNoImageUploaded: "Please upload a chart screenshot.",
                msgSelectAssetTimeframe: "Please select a Currency.", // Teks pesan validasi diubah
                msgAnalysisComplete: "Analysis complete!",
                msgServerError: "Server error during analysis. Please try again.",
                msgFailedAnalysis: "Failed to get analysis.",
                msgErrorPrefix: "Error: "
            },
            id: {
                headerTitle: "MGLYZER 2.2",
                headerSubtitle: "Unggah tangkapan layar grafik terbaru Anda dan biarkan AI menganalisis arah pasar untuk Kripto, Forex, dan Komoditas.",
                inputSectionTitle: "Unggah Grafik & Detail",
                labelAssetType: "Mata Uang:", // Teks diubah, key tetap
                labelAdditionalNotes: "Konteks/Catatan Tambahan (Opsional):",
                placeholderNotes: "cth: 'Mencari level resistensi', 'Apakah ini setup bullish?'",
                labelUploadChart: "Unggah Tangkapan Layar Grafik:",
                uploadAreaText: "Seret & lepas gambar Anda di sini, atau klik untuk mencari",
                analyzeButton: "Analisis Grafik",
                analyzingButton: "Menganalisis...",
                outputSectionTitle: "Hasil Analisis",
                placeholderAnalysis: "Unggah grafik dan klik 'Analisis Grafik' untuk melihat prediksi AI di sini.",
                footerText: "&copy; 2025 MGLYZER 2.2 by MG Trade. Semua Hak Dilindungi.",
                msgUploadImage: "Mohon unggah file gambar (misal: JPG, PNG).",
                msgFileSize: "Ukuran file gambar melebihi 5MB. Mohon unggah gambar yang lebih kecil.",
                msgNoImageUploaded: "Mohon unggah tangkapan layar grafik.",
                msgSelectAssetTimeframe: "Mohon pilih Mata Uang.", // Teks pesan validasi diubah
                msgAnalysisComplete: "Analisis selesai!",
                msgServerError: "Terjadi kesalahan server saat analisis. Mohon coba lagi.",
                msgFailedAnalysis: "Gagal mendapatkan analisis.",
                msgErrorPrefix: "Kesalahan: "
            }
        };

        // DIUBAH: Variabel "assetTypes" sekarang berisi data mata uang
        const assetTypes = {
            '': { en: 'Select Currency', id: 'Pilih Mata Uang' },
            'USD': { en: 'U.S. Dollar', id: 'Dolar AS' },
            'EUR': { en: 'Euro', id: 'Euro' },
            'JPY': { en: 'Japanese Yen', id: 'Yen Jepang' },
            'GBP': { en: 'British Pound', id: 'Poundsterling Inggris' },
            'CHF': { en: 'Swiss Franc', id: 'Franc Swiss' }
        };
        
        function populateSelectOptions(selectElement, optionsData) {
            selectElement.innerHTML = '';
            for (const value in optionsData) {
                const option = document.createElement('option');
                option.value = value;
                option.textContent = optionsData[value][currentLang];
                selectElement.appendChild(option);
            }
        }

        function updateUI() {
            const t = translations[currentLang];

            headerTitle.textContent = t.headerTitle;
            headerSubtitle.textContent = t.headerSubtitle;
            inputSectionTitle.textContent = t.inputSectionTitle;
            // Key dan variabel tetap sama, hanya nilainya yang berubah sesuai bahasa
            labelAssetType.textContent = t.labelAssetType;
            labelAdditionalNotes.textContent = t.labelAdditionalNotes;
            additionalNotesTextarea.placeholder = t.placeholderNotes;
            labelUploadChart.textContent = t.labelUploadChart;
            uploadAreaText.textContent = t.uploadAreaText;
            buttonText.textContent = t.analyzeButton;
            outputSectionTitle.textContent = t.outputSectionTitle;
            placeholderAnalysis.textContent = t.placeholderAnalysis;
            footerText.innerHTML = t.footerText;
            
            // Logika tetap sama, hanya data di dalam "assetTypes" yang berbeda
            populateSelectOptions(assetTypeSelect, assetTypes);

            langEnBtn.classList.toggle('active', currentLang === 'en');
            langIdBtn.classList.toggle('active', currentLang === 'id');
        }

        updateUI();

        langEnBtn.addEventListener('click', () => {
            currentLang = 'en';
            localStorage.setItem('appLang', 'en');
            updateUI();
        });

        langIdBtn.addEventListener('click', () => {
            currentLang = 'id';
            localStorage.setItem('appLang', 'id');
            updateUI();
        });

        uploadArea.addEventListener('click', () => chartImageInput.click());
        
        uploadArea.addEventListener('dragover', (e) => {
            e.preventDefault();
            uploadArea.classList.add('drag-over');
        });
        uploadArea.addEventListener('dragleave', () => {
            uploadArea.classList.remove('drag-over');
        });
        uploadArea.addEventListener('drop', (e) => {
            e.preventDefault();
            uploadArea.classList.remove('drag-over');
            const files = e.dataTransfer.files;
            if (files.length > 0) {
                handleFile(files[0]);
            }
        });

        chartImageInput.addEventListener('change', (e) => {
            if (e.target.files.length > 0) {
                handleFile(e.target.files[0]);
            }
        });

        function handleFile(file) {
            if (!file.type.startsWith('image/')) {
                showMessage(translations[currentLang].msgUploadImage, 'error');
                imagePreview.style.display = 'none';
                fileNameDisplay.style.display = 'none';
                uploadedFile = null;
                return;
            }
            if (file.size > 5 * 1024 * 1024) { // 5 MB limit
                showMessage(translations[currentLang].msgFileSize, 'error');
                imagePreview.style.display = 'none';
                fileNameDisplay.style.display = 'none';
                uploadedFile = null;
                return;
            }

            uploadedFile = file;
            const reader = new FileReader();
            reader.onload = (e) => {
                imagePreview.src = e.target.result;
                imagePreview.style.display = 'block';
                fileNameDisplay.textContent = file.name;
                fileNameDisplay.style.display = 'block';
            };
            reader.readAsDataURL(file);
            hideMessage();
        }

        chartAnalysisForm.addEventListener('submit', async function(event) {
            event.preventDefault();

            analysisResultDiv.innerHTML = `<p class="placeholder-text">${translations[currentLang].analyzingButton}...</p>`;
            hideMessage();

            if (!uploadedFile) {
                showMessage(translations[currentLang].msgNoImageUploaded, 'error');
                return;
            }
            
            // Logika validasi tetap sama
            if (!assetTypeSelect.value) { 
                showMessage(translations[currentLang].msgSelectAssetTimeframe, 'error');
                return;
            }

            setLoadingState(true);

            const formData = new FormData();
            formData.append('image', uploadedFile);
            // Key untuk form data tetap "assetType"
            formData.append('assetType', assetTypeSelect.value);
            formData.append('additionalNotes', additionalNotesTextarea.value);
            formData.append('outputLanguage', currentLang);

            try {
                const response = await fetch('/api/analyze-chart', {
                    method: 'POST',
                    body: formData,
                });

                if (!response.ok) {
                    const errorData = await response.json();
                    throw new Error(errorData.message || translations[currentLang].msgServerError);
                }

                const data = await response.json();
                displayAnalysisResults(data.analysis);
                showMessage(translations[currentLang].msgAnalysisComplete, 'success');

            } catch (err) {
                console.error('Analysis error:', err);
                analysisResultDiv.innerHTML = `<p class="placeholder-text">${translations[currentLang].msgFailedAnalysis}</p>`;
                showMessage(`${translations[currentLang].msgErrorPrefix} ${err.message}`, 'error');
            } finally {
                setLoadingState(false);
            }
        });

        function setLoadingState(isLoading) {
            analyzeBtn.disabled = isLoading;
            buttonText.textContent = isLoading ? translations[currentLang].analyzingButton : translations[currentLang].analyzeButton;
            loadingSpinner.style.display = isLoading ? 'inline-block' : 'none';
        }

        function showMessage(msg, type) {
            messageBox.textContent = msg;
            messageBox.className = `message-box ${type}-message`;
            messageBox.style.display = 'block';
        }

        function hideMessage() {
            messageBox.style.display = 'none';
        }

        function displayAnalysisResults(analysis) {
            let htmlContent = '';
            if (typeof analysis === 'string') {
                htmlContent = `<p>${analysis.replace(/\n/g, '<br>')}</p>`;
            } else if (typeof analysis === 'object') {
                htmlContent += `<div class="result-item"><h3>${currentLang === 'en' ? 'Market Direction' : 'Arah Pasar'}:</h3><p><strong>${analysis.direction || 'N/A'}</strong></p></div>`;
                if (analysis.rationale) {
                     htmlContent += `<div class="result-item"><h3>${currentLang === 'en' ? 'Rationale' : 'Alasan'}:</h3><p>${analysis.rationale}</p></div>`;
                }
                if (analysis.support) {
                    htmlContent += `<div class="result-item"><h3>${currentLang === 'en' ? 'Support Level' : 'Level Dukungan'}:</h3><p>${analysis.support}</p></div>`;
                }
                 if (analysis.resistance) {
                    htmlContent += `<div class="result-item"><h3>${currentLang === 'en' ? 'Resistance Level' : 'Level Resistensi'}:</h3><p>${analysis.resistance}</p></div>`;
                }                    
            } else {
                htmlContent = `<p class="placeholder-text">${translations[currentLang].placeholderAnalysis}</p>`;
            }
            analysisResultDiv.innerHTML = htmlContent;
        }
    });
</script>
    
    <script>
        function openLink() {
            // Disable the button to prevent further clicks
            const button = document.getElementById("registerButton");
            button.disabled = true;
            button.textContent = "Redirecting..."; // Change text to indicate action

            // Set the link (change URL as needed)
            const link = "https://headway.partners/user/signup?hwp=3843d4"; // Replace with the actual link
            setTimeout(() => {
                window.location.href = link; // Redirect to the desired URL
            }, 1000); // Redirect after 1 second delay
        }
    </script>
    
    <script>
        // --- SCRIPT BARU UNTUK FITUR LIGHT/DARK MODE ---
        document.addEventListener('DOMContentLoaded', () => {
            const themeToggle = document.getElementById('theme-toggle');
            const htmlEl = document.documentElement;

            // Function to set theme
            const applyTheme = (theme) => {
                htmlEl.setAttribute('data-theme', theme);
                themeToggle.innerHTML = theme === 'dark' ? '<i class="fas fa-sun"></i>' : '<i class="fas fa-moon"></i>';
                localStorage.setItem('theme', theme);
            };
            
            // Check for saved theme in localStorage, or system preference, or default to dark
            const savedTheme = localStorage.getItem('theme');
            const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
            const initialTheme = savedTheme || (prefersDark ? 'dark' : 'light');

            applyTheme(initialTheme);

            // Event listener for the toggle button
            themeToggle.addEventListener('click', () => {
                const currentTheme = htmlEl.getAttribute('data-theme');
                const newTheme = currentTheme === 'dark' ? 'light' : 'dark';
                applyTheme(newTheme);
            });
        });
    </script>
</body>
</html>
                
  